import{e as ze,f as V,r as L,A as ce,B as it,C as Xe,x as me,g as ne,D as re,c as u,o as c,a as e,n as Q,u as t,t as w,h as W,F as pe,l as fe,E as ct,G as Ve,H as te,p as Ce,m as ut,q as Ye,k as he,b as ie,i as dt,I as vt,s as gt,w as mt}from"./ieS4v_zz.js";import{u as je,a as ht,b as pt,c as ft,d as yt}from"./B7WrlaMe.js";import{u as ve}from"./Cq0N2LJF.js";import{_ as De}from"./DlAUqK2U.js";import{u as bt}from"./BUt7TLaz.js";const de=b=>{const v=String(b.getMonth()+1).padStart(2,"0"),r=String(b.getDate()).padStart(2,"0");return`${v}/${r}`},xt=b=>b>=1?`${b}s`:`1/${Math.round(1/b)}s`,wt=(b,v)=>b==="NIKON CORPORATION"?v||"Nikon Camera":`${b} ${v}`.trim(),kt=b=>{var v;if(b.camera){const r=(v=b.filename.match(/DSC_(\d+)/))==null?void 0:v[1];return r?`攝影 #${r}`:"攝影作品"}return b.title},_t=b=>{if(!b.tags||b.tags.length===0)return null;const v=["後製","夜拍","人像","望遠","廣角","淺景深","標準","日光"];for(const r of v)if(b.tags.includes(r))return r;return b.tags[0]},$t=b=>{const v=["h-64","h-80","h-48","h-72","h-56"];return v[b%v.length]},It=async()=>(await $fetch("/galleryList.json")).Img.map(v=>({id:`digital-${v.filename}`,filename:v.filename,title:v.title,description:v.content,date:v.time,time:v.time,color:v.color,category:"digital",visible:!0})),Mt=async()=>{const b=await $fetch("/photographyList.json");return{works:b.Img.map(r=>({id:`photo-${r.filename}`,filename:r.filename,title:r.title,description:r.content,date:r.time,time:r.time,tags:r.tags||[],event:r.event||null,camera:r.camera,model:r.model,focalLength:r.focalLength,aperture:r.aperture,iso:r.iso,shutterSpeed:r.shutterSpeed,category:"photography",visible:!0})),eventStats:b.eventStats||{}}},xe=ze("gallery",()=>{const{state:b,isLoading:v,error:r,execute:$}=je(It,[],{immediate:!1,resetOnExecute:!1}),{state:h,isLoading:S,error:M,execute:d}=je(Mt,{works:[],eventStats:{}},{immediate:!1,resetOnExecute:!1}),g=V(()=>h.value.works),P=V(()=>h.value.eventStats),N=V(()=>v.value||S.value),f=ht("gallery-filters",{selectedCategory:"all",selectedEvent:null,searchQuery:"",yearFilter:null}),n=L({}),l=L(new Map),I=V(()=>{const y=`allWorks-${b.value.length}-${g.value.length}`;if(l.value.has(y))return l.value.get(y);const a=[...b.value.map(T=>({...T,category:"digital"})),...g.value.map(T=>({...T,category:"photography"}))].sort((T,i)=>new Date(i.time).getTime()-new Date(T.time).getTime());return l.value.set(y,a),a}),s=V(()=>{const{selectedCategory:y,selectedEvent:p}=f.value;let a=[];return y==="digital"?a=b.value:y==="photography"?(a=g.value,p&&(a=a.filter(T=>T.event&&T.event.name===p))):a=I.value,a}),o=V(()=>{const{searchQuery:y,yearFilter:p}=f.value;let a=s.value;if(y){const T=y.toLowerCase();a=a.filter(i=>{var X;return i.title.toLowerCase().includes(T)||i.description.toLowerCase().includes(T)||((X=i.tags)==null?void 0:X.some(A=>A.toLowerCase().includes(T)))})}return p&&(a=a.filter(T=>new Date(T.date).getFullYear().toString()===p)),a.sort((T,i)=>new Date(i.date).getTime()-new Date(T.date).getTime())}),k=V(()=>{const y=s.value;if(!y.some(i=>i.event))return[];const a=new Map;return y.forEach(i=>{var H;const X=((H=i.event)==null?void 0:H.name)||null,A=X||"no-event";a.has(A)||a.set(A,{eventName:X,eventInfo:i.event,images:[],timeRange:""}),a.get(A).images.push(i)}),Array.from(a.values()).map(i=>{const X=i.images.map(R=>new Date(R.time)),A=new Date(Math.min(...X)),H=new Date(Math.max(...X));return i.timeRange=A.getTime()===H.getTime()?de(A):`${de(A)} - ${de(H)}`,i.images.sort((R,oe)=>new Date(oe.time).getTime()-new Date(R.time).getTime()),i}).sort((i,X)=>{const A=Math.max(...i.images.map(R=>new Date(R.time).getTime()));return Math.max(...X.images.map(R=>new Date(R.time).getTime()))-A})}),z=V(()=>{const y=`mixedItems-${s.value.length}-${JSON.stringify(f.value)}`;if(l.value.has(y))return l.value.get(y);const p=[],a=new Map;s.value.forEach(i=>{let X="no-event",A=null,H=null;if(i.category==="photography"&&i.event)X=i.event.name,A=i.event.name,H=i.event;else if(i.category==="digital"){const R=new Date(i.time).getFullYear();X=`digital-${R}`,A=`數位作品 ${R}`}else A="攝影作品";a.has(X)||a.set(X,{eventName:A,eventInfo:H,images:[],timeRange:""}),a.get(X).images.push(i)}),a.forEach((i,X)=>{const A=i.images.map(oe=>new Date(oe.time)),H=new Date(Math.min(...A)),R=new Date(Math.max(...A));i.timeRange=H.getTime()===R.getTime()?de(H):`${de(H)} - ${de(R)}`,i.images.sort((oe,Se)=>new Date(Se.time).getTime()-new Date(oe.time).getTime()),p.push({type:"group",key:`group-${X}`,...i})});const T=p.sort((i,X)=>{const A=Math.max(...(i.images||[]).map(R=>new Date(R.time).getTime()));return Math.max(...(X.images||[]).map(R=>new Date(R.time).getTime()))-A});return l.value.set(y,T),T}),Y=V(()=>{const y={};return g.value.forEach(p=>{if(p.event&&p.event.name){const a=p.event.name,T=new Date(p.time).getTime();(!y[a]||T>y[a])&&(y[a]=T)}}),Object.entries(P.value).map(([p,a])=>({name:p,count:a,latestTime:y[p]||0})).sort((p,a)=>a.latestTime-p.latestTime).map(({name:p,count:a})=>({name:p,count:a}))}),D=V(()=>[...new Set(I.value.map(p=>new Date(p.date).getFullYear().toString()))].sort((p,a)=>a.localeCompare(p))),m=V(()=>({all:b.value.length+g.value.length,digital:b.value.length,photography:g.value.length})),E=async()=>{await Promise.all([$(),d()])},C=it(y=>{f.value.searchQuery=y,x(["mixedItems","filteredItems"])},300),B=y=>{f.value.selectedCategory=y,x(["mixedItems"])},F=y=>{f.value.selectedEvent=y,x(["mixedItems"])},O=y=>{C(y)},U=y=>{f.value.yearFilter=y,x(["filteredItems"])},Z=()=>{f.value.selectedCategory="all",f.value.selectedEvent=null,f.value.searchQuery="",f.value.yearFilter=null,x()},J=y=>{n.value[y]=!n.value[y]},j=(y,p)=>{if(!y.event)return!1;const a=y.event.name;for(let T=0;T<p;T++){const i=s.value[T];if(i.event&&i.event.name===a)return!1}return!0},x=y=>{y?y.forEach(p=>{for(const a of l.value.keys())a.includes(p)&&l.value.delete(a)}):l.value.clear()},le=async()=>{x(),await E()};return ce([b,g],()=>{x(["allWorks","mixedItems"])},{deep:!0}),{digitalWorks:b,photographyWorks:g,eventStats:P,expandedGroups:n,isLoading:N,filterState:f,allWorks:I,currentWorks:s,filteredItems:o,groupedWorks:k,mixedPhotoItems:z,availableEvents:Y,availableYears:D,categoryStats:m,loadAllWorks:E,loadDigitalWorks:$,loadPhotographyWorks:d,setSelectedCategory:B,setSelectedEvent:F,setSearchQuery:O,setYearFilter:U,clearFilters:Z,toggleGroupExpansion:J,shouldShowEventOnTimeline:j,refreshData:le,clearCache:x,formatDate:de,formatShutterSpeed:xt,formatCameraName:wt,getDisplayTitle:kt,getPrimaryTag:_t,getImageClass:$t,digitalError:r,photographyError:M}}),ye=ze("imageViewer",()=>{const b=L(!1),v=L([]),r=L(0),$=L(1),h=L(0),S=L(0),M=L(!1),d=L(!0),g=L(.4),P=L(!1),N=L(!1),f=L({x:0,y:0}),n=L({x:0,y:0}),l=L({x:0,y:0,width:0,height:0}),I=L(!1),s=L(!1),o=L(0),k=L(0),z=L(!1),Y=L(320),D=L(0),m=L(!1),E=Xe({}),C=L(!1),B=L(0),F=140,O=V(()=>v.value[r.value]||null),U=V(()=>$.value<5),Z=V(()=>$.value>.5),J=V(()=>r.value>0),j=V(()=>r.value<v.value.length-1),x=V(()=>`scale(${$.value}) translate(${h.value}px, ${S.value}px)`),le=V(()=>{const _={transform:x.value,transformOrigin:"center center"};return d.value?{..._,maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"}:{..._,maxWidth:"none",maxHeight:"none",width:"auto",height:"auto"}}),y=V(()=>(l.value,{left:Math.min(f.value.x,n.value.x)+"px",top:Math.min(f.value.y,n.value.y)+"px",width:Math.abs(n.value.x-f.value.x)+"px",height:Math.abs(n.value.y-f.value.y)+"px"})),p=(_,G)=>{const K=G.findIndex(q=>q.id===_.id);v.value=G,r.value=Math.max(0,K),b.value=!0,document.body.style.overflow="hidden",ke()},a=()=>{P.value=!P.value,P.value||T()},T=()=>{N.value=!1,f.value={x:0,y:0},n.value={x:0,y:0},l.value={x:0,y:0,width:0,height:0}},i=(_,G)=>{P.value&&(N.value=!0,f.value={x:_,y:G},n.value={x:_,y:G})},X=(_,G)=>{if(!N.value)return;n.value={x:_,y:G};const K={x:Math.min(f.value.x,_),y:Math.min(f.value.y,G),width:Math.abs(_-f.value.x),height:Math.abs(G-f.value.y)};l.value=K},A=()=>{if(N.value){if(N.value=!1,l.value.width<20||l.value.height<20){T();return}H()}},H=()=>{const _=l.value;if(_.width===0||_.height===0)return;const G=document.querySelector(".image-viewer-area"),K=document.querySelector(".image-viewer-area img");if(!G||!K)return;const q=G.getBoundingClientRect(),se=K.getBoundingClientRect(),Ie=q.width/2,ue=q.height/2,ee=_.x+_.width/2,ge=_.y+_.height/2,Me=se.left-q.left,ae=se.top-q.top,Ke=ee-Me,qe=ge-ae,Ue=Ke/se.width,Qe=qe/se.height,We=.8,Ze=q.width*We/_.width,Je=q.height*We/_.height,et=Math.min(Math.max(Math.min(Ze,Je),.5),5),tt=K.naturalWidth,ot=K.naturalHeight,st=q.width/q.height,Te=tt/ot;let Ee,Le;Te>st?(Ee=q.width,Le=q.width/Te):(Ee=q.height*Te,Le=q.height);const at=Ue*Ee,nt=Qe*Le,rt=(Ie-at)/g.value,lt=(ue-nt)/g.value;$.value=et,h.value=rt,S.value=lt,d.value=!1,T(),P.value=!1,be()},R=()=>{b.value=!1,document.body.style.overflow="",we()},oe=()=>{J.value&&$e(r.value-1)},Se=()=>{j.value&&$e(r.value+1)},we=()=>{$.value=1,h.value=0,S.value=0,d.value=!0,be()},Be=()=>{d.value=!d.value,d.value&&we()},Ae=()=>{U.value&&($.value=Math.min($.value*1.5,5),be())},He=()=>{if(Z.value){const _=Math.max($.value/1.5,.5);$.value=_,_<=1&&(h.value=0,S.value=0),be()}},be=()=>{I.value=$.value>1.2},ke=()=>{const _=z.value?Y.value+20:20;o.value=window.innerWidth-_-180,k.value=window.innerHeight-220},Re=()=>{z.value=!z.value,me(()=>{ke()})},Fe=_=>{Y.value=_,me(()=>{ke()})},_e=(_,G)=>{const K=v.value.length;if(K===1)return{x:0,y:-F};const q=(_-G+K)%K,se=180/Math.max(1,K-1),ue=(0+q*se)*Math.PI/180,ee=Math.cos(ue)*F,ge=-Math.sin(ue)*F;return{x:ee,y:ge}},Pe=(_,G,K)=>_+(G-_)*K,Oe=_=>1-(1-_)*(1-_),Ge=(_,G)=>{const K=v.value.length;if(K<=1)return;C.value=!0,B.value=performance.now();const q={},se={};for(let ee=0;ee<K;ee++)q[ee]=_e(ee,_),se[ee]=_e(ee,G),E[ee]={...q[ee]};const Ie=400,ue=ee=>{const ge=Math.min((ee-B.value)/Ie,1),Me=Oe(ge);for(let ae=0;ae<K;ae++)E[ae].x=Pe(q[ae].x,se[ae].x,Me),E[ae].y=Pe(q[ae].y,se[ae].y,Me);ge<1?requestAnimationFrame(ue):C.value=!1};requestAnimationFrame(ue)},Ne=_=>{v.value.forEach((G,K)=>{E[K]=_e(K,_)})},$e=_=>{if(_===r.value||C.value)return;const G=r.value;D.value=G,m.value=!0,Ge(G,_),setTimeout(()=>{r.value=_,m.value=!1,we(),Ne(_)},400)};return{isOpen:b,viewerImages:v,currentImageIndex:r,viewerScale:$,viewerTranslateX:h,viewerTranslateY:S,isDragging:M,fitToScreen:d,dragSensitivity:g,showNavigator:I,navigatorDragging:s,navigatorX:o,navigatorY:k,showInfoPanel:z,infoPanelWidth:Y,previousImageIndex:D,isTransitioning:m,posMap:E,animating:C,radius:F,isSelectionMode:P,isSelecting:N,selectionStart:f,selectionEnd:n,selectionRect:l,currentViewerImage:O,canZoomIn:U,canZoomOut:Z,hasPrevious:J,hasNext:j,imageTransform:x,imageStyle:le,selectionBoxStyle:y,openImageViewer:p,closeImageViewer:R,goToPreviousImage:oe,goToNextImage:Se,resetTransform:we,toggleFitToScreen:Be,zoomIn:Ae,zoomOut:He,updateNavigatorVisibility:be,initNavigatorPosition:ke,toggleInfoPanel:Re,updateInfoPanelWidth:Fe,calcXY:_e,updatePosMap:Ne,selectRadialImage:$e,handleCenterButtonClick:()=>{r.value!==0&&$e(0)},toggleSelectionMode:a,resetSelection:T,startSelection:i,updateSelection:X,endSelection:A,zoomToSelection:H}}),Ct={class:"flex space-x-8 mb-8"},St=ne({__name:"GalleryTabBar",setup(b){const v=xe(),{filterState:r,categoryStats:$}=re(v),{setSelectedCategory:h}=v;return(S,M)=>(c(),u("div",Ct,[e("button",{onClick:M[0]||(M[0]=d=>t(h)("digital")),class:Q([t(r).selectedCategory==="digital"?"border-b-2 border-gray-800 text-gray-800":"text-gray-500 hover:text-gray-700","pb-2 font-light tracking-wide transition-colors duration-200"])}," 數位繪圖 ("+w(t($).digital)+") ",3),e("button",{onClick:M[1]||(M[1]=d=>t(h)("photography")),class:Q([t(r).selectedCategory==="photography"?"border-b-2 border-gray-800 text-gray-800":"text-gray-500 hover:text-gray-700","pb-2 font-light tracking-wide transition-colors duration-200"])}," 攝影作品 ("+w(t($).photography)+") ",3),e("button",{onClick:M[2]||(M[2]=d=>t(h)("all")),class:Q([t(r).selectedCategory==="all"?"border-b-2 border-gray-800 text-gray-800":"text-gray-500 hover:text-gray-700","pb-2 font-light tracking-wide transition-colors duration-200"])}," 全部作品 ("+w(t($).all)+") ",3)]))}}),Tt={key:0,class:"mb-8"},Et={class:"flex flex-wrap gap-3 mb-4"},Lt=["onClick"],Dt=ne({__name:"EventFilter",setup(b){const v=xe(),{filterState:r,availableEvents:$,photographyWorks:h}=re(v),{setSelectedEvent:S}=v;return ce(()=>r.value.selectedCategory,M=>{M!=="photography"&&r.value.selectedEvent&&S(null)}),(M,d)=>t(r).selectedCategory==="photography"&&t($).length>0?(c(),u("div",Tt,[e("div",Et,[e("button",{onClick:d[0]||(d[0]=g=>t(S)(null)),class:Q([t(r).selectedEvent===null?"bg-gray-800 text-white":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50","px-4 py-2 rounded-lg text-sm font-light transition-colors duration-200"])}," 全部事件 ("+w(t(h).length)+") ",3),(c(!0),u(pe,null,fe(t($),g=>(c(),u("button",{key:g.name,onClick:P=>t(S)(g.name),class:Q([t(r).selectedEvent===g.name?"bg-gray-800 text-white":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50","px-4 py-2 rounded-lg text-sm font-light transition-colors duration-200"])},w(g.name)+" ("+w(g.count)+") ",11,Lt))),128))])])):W("",!0)}}),Pt=["title"],Nt={class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Wt={key:0,"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},jt={key:1,"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"},zt={class:"text-sm text-gray-500 font-light tracking-wide mb-10"},Xt={class:"transform md:-rotate-90 origin-center whitespace-nowrap inline-block"},Vt={key:0,class:"text-gray-700 mb-1 truncate"},Yt={key:1,class:"text-gray-500 truncate"},Bt=ne({__name:"GalleryTimelineItem",props:{index:{},timeLabel:{},eventInfo:{},eventKey:{},showEventControl:{type:Boolean,default:!1},showEventInfo:{type:Boolean,default:!1}},setup(b){const v=b,r=xe(),{expandedGroups:$}=re(r),{toggleGroupExpansion:h}=r,S=V(()=>{var d;return((d=v.eventInfo)==null?void 0:d.name)||"事件"}),M=V(()=>v.eventKey&&$.value[v.eventKey]||!1);return(d,g)=>(c(),u("div",{class:Q(["flex items-start relative",d.index%2===0?"md:flex-row":"md:flex-row-reverse"])},[e("div",{class:Q(["md:w-40 flex-shrink-0 text-right md:text-left mb-4 md:mb-0 relative",d.index%2===0?"md:mr-16":"md:ml-16 md:text-right"])},[e("div",{class:Q(["absolute w-4 h-4 bg-white border-2 border-gray-400 rounded-full hidden md:block z-10",d.index%2===0?"left-[-4.5rem]":"right-[-4.5rem]"])},null,2),d.showEventControl?(c(),u("div",{key:0,class:Q(["absolute hidden md:block z-20",d.index%2===0?"left-[-3.5rem]":"right-[-3.5rem]"])},[e("button",{onClick:g[0]||(g[0]=P=>d.eventKey&&t(h)(d.eventKey)),class:Q(["w-5 h-5 rounded-full transition-all duration-200 flex items-center justify-center group shadow-sm",M.value?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"]),title:`${M.value?"折疊":"展開"} ${S.value} 的作品`},[(c(),u("svg",Nt,[M.value?(c(),u("path",Wt)):(c(),u("path",jt))]))],10,Pt)],2)):W("",!0),e("div",zt,[e("span",Xt,w(d.timeLabel),1)]),d.eventInfo&&d.showEventInfo&&(d.eventInfo.description||d.eventInfo.location)?(c(),u("div",{key:1,class:Q(["hidden md:block",d.index%2===0?"":"text-right"])},[e("div",{class:Q(["p-2 bg-white/90 backdrop-blur-sm rounded text-xs shadow-sm max-w-32",d.index%2===0?"text-left":"text-right"])},[d.eventInfo.description?(c(),u("div",Vt,w(d.eventInfo.description),1)):W("",!0),d.eventInfo.location?(c(),u("div",Yt," 📍 "+w(d.eventInfo.location),1)):W("",!0)],2)],2)):W("",!0)],2),e("div",{class:Q(["flex-1 md:max-w-2xl",d.index%2===0?"md:ml-16":"md:mr-16"])},[ct(d.$slots,"default")],2)],2))}}),At=["src","alt"],Ht={key:1,class:"w-full h-full bg-gray-200 animate-pulse flex items-center justify-center"},Rt={key:2,class:"w-full h-full bg-red-50 flex items-center justify-center"},Ft={key:3,class:"absolute top-4 right-4"},Ot={key:0,class:"px-2 py-1 text-xs font-light border border-gray-200 text-gray-600 rounded bg-white/90 backdrop-blur-sm"},Gt={key:1,class:"px-3 py-1 rounded-full text-xs font-light bg-white/90 backdrop-blur-sm text-gray-700 shadow-sm border border-gray-100"},Kt={key:4,class:"absolute top-4 left-4 md:hidden"},qt={class:"px-2 py-1 rounded text-xs font-light bg-gray-800/80 text-white"},Ut={class:"p-6 bg-white/80 backdrop-blur-sm mt-2 rounded-lg border border-gray-100"},Qt={class:"flex items-center justify-between mb-4"},Zt={class:"text-xl font-light text-gray-800 tracking-wide"},Jt=["title"],eo={key:0,class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},to={key:1,class:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},oo={key:0},so={class:"flex items-center text-sm text-gray-500 mb-4 font-light"},ao={class:"grid grid-cols-4 gap-4 text-xs border-t border-gray-100 pt-4"},no={key:0,class:"text-center"},ro={class:"font-medium text-gray-700"},lo={key:1,class:"text-center"},io={class:"font-medium text-gray-700"},co={key:2,class:"text-center"},uo={class:"font-medium text-gray-700"},vo={key:3,class:"text-center"},go={class:"font-medium text-gray-700"},mo={key:1,class:"border-t border-gray-100 pt-4"},ho={class:"text-gray-600 text-sm leading-relaxed font-light"},po=ne({__name:"PhotoCard",props:{image:{},index:{}},emits:["openViewer"],setup(b,{emit:v}){const r=b,$=v,h=xe(),S=L(),M=L(!1),d=L(!1),g=L(!1);pt(S,([{isIntersecting:j}])=>{P.value=j},{threshold:.1});const P=L(!1),{x:N,y:f}=ft({target:S}),{copy:n,copied:l}=yt(),{getImagePath:I,getFullImageUrl:s}=ve(),o=L(0),k=L(0),z=V(()=>h.getDisplayTitle(r.image)),Y=V(()=>h.getPrimaryTag(r.image)),D=V(()=>r.image.camera&&r.image.model?h.formatCameraName(r.image.camera,r.image.model):""),m=V(()=>r.image.shutterSpeed?h.formatShutterSpeed(r.image.shutterSpeed):""),E=V(()=>r.index!==void 0?h.getImageClass(r.index):"h-64"),C=()=>{M.value=!0,d.value=!1},B=()=>{d.value=!0,M.value=!1},F=j=>{var le;g.value=!0;const x=(le=S.value)==null?void 0:le.getBoundingClientRect();if(x){const y=x.left+x.width/2,p=x.top+x.height/2,a=(j.clientY-p)/10,T=(y-j.clientX)/10;o.value=Math.max(-10,Math.min(10,a)),k.value=Math.max(-10,Math.min(10,T))}},O=()=>{g.value=!1,o.value=0,k.value=0},U=Ve(),Z=async j=>{j.stopPropagation();try{const x=s(r.image.filename);await n(x),U.success("連結已複製！","圖片連結已複製到剪貼簿")}catch{U.error("複製失敗","無法複製連結到剪貼簿")}},J=()=>{$("openViewer",r.image)};return(j,x)=>(c(),u("div",{ref_key:"cardRef",ref:S,class:"group hover:transform hover:scale-105 transition-all duration-300 cursor-pointer",onMouseenter:F,onMouseleave:O,onClick:J,style:te({transform:`perspective(1000px) rotateX(${o.value}deg) rotateY(${k.value}deg)`})},[e("div",{class:Q(["relative overflow-hidden rounded-lg border border-gray-100",E.value])},[P.value?(c(),u("img",{key:0,src:t(I)(j.image.filename),alt:j.image.title,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onLoad:C,onError:B},null,40,At)):M.value?d.value?(c(),u("div",Rt,x[1]||(x[1]=[e("div",{class:"text-center"},[e("svg",{class:"w-8 h-8 text-red-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("p",{class:"text-xs text-red-600"},"載入失敗")],-1)]))):W("",!0):(c(),u("div",Ht,x[0]||(x[0]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z","clip-rule":"evenodd"})],-1)]))),P.value?(c(),u("div",Ft,[Y.value?(c(),u("span",Ot,w(Y.value),1)):(c(),u("span",Gt,w(j.image.category==="digital"?"繪圖":"攝影"),1))])):W("",!0),j.image.event&&P.value?(c(),u("div",Kt,[e("span",qt,w(j.image.event.name),1)])):W("",!0),g.value&&t(N)!==null&&t(f)!==null?(c(),u("div",{key:5,class:"absolute pointer-events-none transition-opacity duration-200",style:te({left:`${t(N)}px`,top:`${t(f)}px`,transform:"translate(-50%, -50%)"})},x[2]||(x[2]=[e("div",{class:"w-2 h-2 bg-blue-500 rounded-full opacity-60"},null,-1)]),4)):W("",!0)],2),e("div",Ut,[e("div",Qt,[e("h3",Zt,w(z.value),1),e("button",{onClick:Z,class:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-1 hover:bg-gray-100 rounded",title:t(l)?"已複製！":"複製圖片連結"},[t(l)?(c(),u("svg",to,x[4]||(x[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(c(),u("svg",eo,x[3]||(x[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])))],8,Jt)]),j.image.category==="photography"&&j.image.camera?(c(),u("div",oo,[e("div",so,[x[5]||(x[5]=e("svg",{class:"w-4 h-4 mr-2 opacity-60",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z","clip-rule":"evenodd"})],-1)),e("span",null,w(D.value),1)]),e("div",ao,[j.image.focalLength?(c(),u("div",no,[x[6]||(x[6]=e("div",{class:"text-gray-400 mb-1 font-light"},"焦距",-1)),e("div",ro,w(j.image.focalLength)+"mm",1)])):W("",!0),j.image.aperture?(c(),u("div",lo,[x[7]||(x[7]=e("div",{class:"text-gray-400 mb-1 font-light"},"光圈",-1)),e("div",io,"f/"+w(j.image.aperture),1)])):W("",!0),j.image.iso?(c(),u("div",co,[x[8]||(x[8]=e("div",{class:"text-gray-400 mb-1 font-light"},"ISO",-1)),e("div",uo,w(j.image.iso),1)])):W("",!0),j.image.shutterSpeed?(c(),u("div",vo,[x[9]||(x[9]=e("div",{class:"text-gray-400 mb-1 font-light"},"快門",-1)),e("div",go,w(m.value),1)])):W("",!0)])])):(c(),u("div",mo,[e("p",ho,w(j.image.description),1)]))])],36))}}),fo={class:"space-y-3"},yo={class:"bg-gray-800 border border-gray-600 rounded-lg p-3"},bo=["width"],xo=ne({__name:"ImageHistogram",setup(b,{expose:v}){const r=ye(),{getImagePath:$}=ve(),{currentViewerImage:h,showInfoPanel:S,infoPanelWidth:M}=re(r),d=L(),g=Xe({red:new Array(256).fill(0),green:new Array(256).fill(0),blue:new Array(256).fill(0)}),P=V(()=>{const n=Math.max(200,M.value-80);return Math.min(n,400)}),N=async()=>{if(!(!h.value||!d.value))try{const n=new Image;n.crossOrigin="anonymous",await new Promise((z,Y)=>{n.onload=z,n.onerror=Y,n.src=$(h.value.filename)});const l=document.createElement("canvas"),I=l.getContext("2d");if(!I)return;const s=Math.min(200/n.width,200/n.height);l.width=n.width*s,l.height=n.height*s,I.drawImage(n,0,0,l.width,l.height);const k=I.getImageData(0,0,l.width,l.height).data;g.red.fill(0),g.green.fill(0),g.blue.fill(0);for(let z=0;z<k.length;z+=4){const Y=k[z],D=k[z+1],m=k[z+2];g.red[Y]++,g.green[D]++,g.blue[m]++}f()}catch(n){console.warn("無法生成直方圖:",n)}},f=()=>{const n=d.value;if(!n)return;const l=n.getContext("2d");if(!l)return;const I=n.width,s=n.height;l.fillStyle="#1f2937",l.fillRect(0,0,I,s);const o=Math.max(...g.red),k=Math.max(...g.green),z=Math.max(...g.blue),Y=Math.max(o,k,z);if(Y===0)return;const D=I/256;for(let m=0;m<256;m++){const E=m*D,C=g.red[m]/Y*s*.8;l.fillStyle="rgba(255, 0, 0, 0.7)",l.fillRect(E,s-C,D,C);const B=g.green[m]/Y*s*.8;l.globalCompositeOperation="screen",l.fillStyle="rgba(0, 255, 0, 0.7)",l.fillRect(E,s-B,D,B);const F=g.blue[m]/Y*s*.8;l.fillStyle="rgba(0, 0, 255, 0.7)",l.fillRect(E,s-F,D,F),l.globalCompositeOperation="source-over"}l.strokeStyle="rgba(255, 255, 255, 0.1)",l.lineWidth=1;for(let m=0;m<=4;m++){const E=m*I/4;l.beginPath(),l.moveTo(E,0),l.lineTo(E,s),l.stroke()}for(let m=0;m<=4;m++){const E=m*s/4;l.beginPath(),l.moveTo(0,E),l.lineTo(I,E),l.stroke()}};return ce(h,()=>{S.value&&me(()=>{N()})}),ce(S,n=>{n&&h.value&&me(()=>{N()})}),ce(M,()=>{S.value&&h.value&&me(()=>{N()})}),Ce(()=>{S.value&&h.value&&me(()=>{N()})}),v({generateHistogram:N}),(n,l)=>(c(),u("div",fo,[l[0]||(l[0]=e("h4",{class:"text-white font-medium border-b border-gray-600 pb-2"},"色彩分佈",-1)),e("div",yo,[e("canvas",{ref_key:"histogramCanvas",ref:d,width:P.value,height:"120",class:"w-full h-full rounded"},null,8,bo)]),l[1]||(l[1]=ut('<div class="flex justify-center space-x-4 text-xs"><div class="flex items-center"><div class="w-3 h-3 bg-red-500 rounded mr-1 opacity-80"></div><span class="text-gray-300">紅</span></div><div class="flex items-center"><div class="w-3 h-3 bg-green-500 rounded mr-1 opacity-80"></div><span class="text-gray-300">綠</span></div><div class="flex items-center"><div class="w-3 h-3 bg-blue-500 rounded mr-1 opacity-80"></div><span class="text-gray-300">藍</span></div></div>',1))]))}}),wo={class:"sticky top-0 bg-black bg-opacity-75 backdrop-blur-sm border-b border-gray-600 p-4"},ko={class:"flex items-center justify-between"},_o={class:"p-4 space-y-6"},$o={class:"text-center"},Io={class:"inline-block border border-gray-600 rounded-lg overflow-hidden bg-gray-800"},Mo=["src","alt"],Co={class:"mt-2 text-sm text-gray-300 text-center font-medium"},So={class:"space-y-3"},To={class:"space-y-2 text-sm"},Eo={class:"flex justify-between"},Lo={class:"text-gray-200 font-mono"},Do={class:"flex justify-between"},Po={class:"text-gray-200"},No={class:"flex justify-between"},Wo={class:"text-gray-200"},jo={class:"flex justify-between"},zo={class:"text-gray-200"},Xo={class:"flex justify-between"},Vo={class:"text-gray-200"},Yo={class:"space-y-3"},Bo={class:"space-y-2 text-sm"},Ao={class:"flex justify-between"},Ho={class:"text-gray-200"},Ro={class:"flex justify-between"},Fo={class:"text-gray-200"},Oo={key:0,class:"flex justify-between"},Go={class:"text-gray-200"},Ko={key:0,class:"space-y-3"},qo={class:"space-y-2 text-sm"},Uo={key:0,class:"flex justify-between"},Qo={class:"text-gray-200"},Zo={key:1,class:"flex justify-between"},Jo={class:"text-gray-200"},es={key:2,class:"flex justify-between"},ts={class:"text-gray-200"},os={key:3,class:"flex justify-between"},ss={class:"text-gray-200"},as={key:1,class:"space-y-3"},ns={class:"flex flex-wrap gap-2"},rs={key:2,class:"space-y-3"},ls={class:"text-gray-300 text-sm leading-relaxed"},is=280,cs=600,us=ne({__name:"ImageInfoPanel",setup(b){const v=ye(),{getImagePath:r}=ve(),{showInfoPanel:$,infoPanelWidth:h,currentViewerImage:S}=re(v),M=L(!1),d=L(0),g=L(320),P=s=>{s.preventDefault(),M.value=!0;const o="touches"in s?s.touches[0].clientX:s.clientX;d.value=o,g.value=h.value,document.addEventListener("mousemove",N),document.addEventListener("mouseup",f),document.addEventListener("touchmove",N,{passive:!1}),document.addEventListener("touchend",f),document.body.style.userSelect="none",document.body.style.cursor="col-resize"},N=s=>{if(!M.value)return;s.preventDefault();const o="touches"in s?s.touches[0].clientX:s.clientX,k=d.value-o,z=Math.max(is,Math.min(cs,g.value+k));v.updateInfoPanelWidth(z)},f=()=>{M.value=!1,document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",N),document.removeEventListener("touchend",f),document.body.style.userSelect="",document.body.style.cursor=""};Ye(()=>{M.value&&f()});const n=V(()=>{var m,E;if(!S.value)return null;const s=S.value;let o=null;try{if(s.date&&s.time){const C=`${s.date} ${s.time}`,B=new Date(C);isNaN(B.getTime())||(o=B)}if(!o&&s.date){const C=new Date(s.date);isNaN(C.getTime())||(o=C)}if(!o&&s.filename){const C=s.filename.match(/(\d{4})-?(\d{2})-?(\d{2})/);if(C){const[,B,F,O]=C,U=new Date(parseInt(B),parseInt(F)-1,parseInt(O));isNaN(U.getTime())||(o=U)}}}catch(C){console.warn("日期解析失敗:",C),o=null}const k=s.iso?1920:1280,z=s.iso?1080:720,Y=`${k} × ${z}`,D=s.category==="photography"?2.5*1024*1024:1.8*1024*1024;return{filename:s.filename,title:s.title||"未命名",description:s.description||"",category:s.category||"未分類",dimensions:Y,fileSize:D,format:((E=(m=s.filename)==null?void 0:m.split(".").pop())==null?void 0:E.toUpperCase())||"UNKNOWN",createdAt:o,updatedAt:o,colors:[],tags:s.tags||[],iso:s.iso,aperture:s.aperture,shutterSpeed:s.shutterSpeed,focalLength:s.focalLength}}),l=V(()=>{var o;if(!((o=n.value)!=null&&o.fileSize))return"未知";const s=n.value.fileSize;return s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:s<1024*1024*1024?`${(s/(1024*1024)).toFixed(1)} MB`:`${(s/(1024*1024*1024)).toFixed(1)} GB`}),I=s=>{if(!s||isNaN(s.getTime()))return"未知";try{return s.toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(o){return console.warn("日期格式化失敗:",o),"未知"}};return(s,o)=>t($)&&t(S)&&n.value?(c(),u("div",{key:0,class:"info-panel fixed top-0 right-0 h-full bg-black bg-opacity-90 backdrop-blur-md border-l border-gray-600 overflow-y-auto z-50 transition-all duration-300",style:te({width:t(h)+"px"}),onWheel:o[1]||(o[1]=he(()=>{},["stop"]))},[e("div",{class:"absolute left-0 top-0 w-2 h-full cursor-col-resize hover:bg-blue-500 hover:bg-opacity-30 transition-colors z-10",onMousedown:P,onTouchstart:P},o[2]||(o[2]=[e("div",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 w-1 h-20 bg-gray-400 rounded-r opacity-70 hover:opacity-100 transition-opacity"},null,-1)]),32),e("div",wo,[e("div",ko,[o[4]||(o[4]=e("h3",{class:"text-white font-medium"},"圖片資訊",-1)),e("button",{onClick:o[0]||(o[0]=(...k)=>t(v).toggleInfoPanel&&t(v).toggleInfoPanel(...k)),class:"p-1 text-gray-400 hover:text-white transition-colors"},o[3]||(o[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])]),e("div",_o,[e("div",$o,[e("div",Io,[e("img",{src:t(r)(t(S).filename),alt:n.value.title,class:"w-32 h-32 object-contain"},null,8,Mo)]),e("div",Co,w(n.value.title),1)]),e("div",So,[o[10]||(o[10]=e("h4",{class:"text-white font-medium border-b border-gray-600 pb-2"},"基本資訊",-1)),e("div",To,[e("div",Eo,[o[5]||(o[5]=e("span",{class:"text-gray-400"},"檔名：",-1)),e("span",Lo,w(n.value.filename),1)]),e("div",Do,[o[6]||(o[6]=e("span",{class:"text-gray-400"},"格式：",-1)),e("span",Po,w(n.value.format),1)]),e("div",No,[o[7]||(o[7]=e("span",{class:"text-gray-400"},"尺寸：",-1)),e("span",Wo,w(n.value.dimensions),1)]),e("div",jo,[o[8]||(o[8]=e("span",{class:"text-gray-400"},"檔案大小：",-1)),e("span",zo,w(l.value),1)]),e("div",Xo,[o[9]||(o[9]=e("span",{class:"text-gray-400"},"類別：",-1)),e("span",Vo,w(n.value.category==="digital"?"數位藝術":"攝影作品"),1)])])]),e("div",Yo,[o[14]||(o[14]=e("h4",{class:"text-white font-medium border-b border-gray-600 pb-2"},"時間資訊",-1)),e("div",Bo,[e("div",Ao,[o[11]||(o[11]=e("span",{class:"text-gray-400"},"日期：",-1)),e("span",Ho,w(t(S).date||"未知"),1)]),e("div",Ro,[o[12]||(o[12]=e("span",{class:"text-gray-400"},"時間：",-1)),e("span",Fo,w(t(S).time||"未知"),1)]),n.value.createdAt?(c(),u("div",Oo,[o[13]||(o[13]=e("span",{class:"text-gray-400"},"建立時間：",-1)),e("span",Go,w(I(n.value.createdAt)),1)])):W("",!0)])]),n.value.category==="photography"&&(n.value.iso||n.value.aperture||n.value.shutterSpeed||n.value.focalLength)?(c(),u("div",Ko,[o[19]||(o[19]=e("h4",{class:"text-white font-medium border-b border-gray-600 pb-2"},"攝影參數",-1)),e("div",qo,[n.value.iso?(c(),u("div",Uo,[o[15]||(o[15]=e("span",{class:"text-gray-400"},"ISO：",-1)),e("span",Qo,w(n.value.iso),1)])):W("",!0),n.value.aperture?(c(),u("div",Zo,[o[16]||(o[16]=e("span",{class:"text-gray-400"},"光圈：",-1)),e("span",Jo,"f/"+w(n.value.aperture),1)])):W("",!0),n.value.shutterSpeed?(c(),u("div",es,[o[17]||(o[17]=e("span",{class:"text-gray-400"},"快門：",-1)),e("span",ts,"1/"+w(n.value.shutterSpeed)+"s",1)])):W("",!0),n.value.focalLength?(c(),u("div",os,[o[18]||(o[18]=e("span",{class:"text-gray-400"},"焦距：",-1)),e("span",ss,w(n.value.focalLength)+"mm",1)])):W("",!0)])])):W("",!0),ie(xo),n.value.tags&&n.value.tags.length>0?(c(),u("div",as,[o[20]||(o[20]=e("h4",{class:"text-white font-medium border-b border-gray-600 pb-2"},"標籤",-1)),e("div",ns,[(c(!0),u(pe,null,fe(n.value.tags,k=>(c(),u("span",{key:k,class:"px-2 py-1 bg-gray-700 text-gray-300 rounded-full text-xs border border-gray-600"},w(k),1))),128))])])):W("",!0),n.value.description?(c(),u("div",rs,[o[21]||(o[21]=e("h4",{class:"text-white font-medium border-b border-gray-600 pb-2"},"描述",-1)),e("p",ls,w(n.value.description),1)])):W("",!0)])],36)):W("",!0)}}),ds=["src","alt"],vs={class:"flex items-center justify-between mt-2 text-xs text-gray-300"},gs=ne({__name:"ImageNavigator",setup(b){const v=ye(),{getImagePath:r}=ve(),{showNavigator:$,navigatorDragging:h,navigatorX:S,navigatorY:M,currentViewerImage:d,viewerScale:g,viewerTranslateX:P,viewerTranslateY:N,showInfoPanel:f,infoPanelWidth:n,dragSensitivity:l}=re(v),{resetTransform:I}=v,s=L(),o=L(),k=V(()=>{if(!o.value||g.value<=1)return null;const D=o.value,m=D.clientWidth,E=D.clientHeight,C=m/g.value,B=E/g.value,F=m/2,O=E/2,U=-P.value/g.value,Z=-N.value/g.value,J=F+U-C/2,j=O+Z-B/2;return{left:Math.max(0,Math.min(J,m-C)),top:Math.max(0,Math.min(j,E-B)),width:C,height:B}}),z=D=>{if(!o.value||h.value)return;const m=o.value.getBoundingClientRect(),E=D.clientX-m.left,C=D.clientY-m.top,B=o.value.clientWidth,F=o.value.clientHeight,O=B/2,U=F/2,Z=(E-O)*g.value,J=(C-U)*g.value;P.value=-Z,N.value=-J},Y=D=>{if(D.target===o.value)return;D.preventDefault(),D.stopPropagation(),h.value=!0;const m=D.clientX-S.value,E=D.clientY-M.value;let C=null;const B=O=>{h.value&&(O.preventDefault(),O.stopPropagation(),C&&cancelAnimationFrame(C),C=requestAnimationFrame(()=>{const U=O.clientX-m,Z=O.clientY-E,J=f.value?n.value:0,j=window.innerWidth-J-180,x=window.innerHeight-200;S.value=Math.max(-20,Math.min(U,j)),M.value=Math.max(20,Math.min(Z,x))}))},F=O=>{O.preventDefault(),O.stopPropagation(),h.value=!1,C&&(cancelAnimationFrame(C),C=null),document.removeEventListener("mousemove",B,{capture:!0}),document.removeEventListener("mouseup",F,{capture:!0})};document.addEventListener("mousemove",B,{capture:!0,passive:!1}),document.addEventListener("mouseup",F,{capture:!0,passive:!1})};return(D,m)=>dt((c(),u("div",{class:"navigator-panel fixed z-40 select-none",style:te({left:t(S)+"px",top:t(M)+"px",transition:t(h)?"none":"all 0.2s ease"}),onWheel:m[1]||(m[1]=he(()=>{},["stop"]))},[e("div",{class:Q(["bg-black bg-opacity-80 backdrop-blur-sm rounded-lg border border-white border-opacity-20 p-2",{"cursor-move":!t(h),"cursor-grabbing":t(h)}]),onMousedown:Y},[m[3]||(m[3]=e("div",{class:"text-white text-xs mb-2 px-1 flex items-center justify-between"},[e("span",null,"導覽器"),e("svg",{class:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})])],-1)),e("div",{ref_key:"navigatorElement",ref:s,class:"relative w-32 h-32 overflow-hidden rounded border border-gray-600"},[t(d)?(c(),u("img",{key:0,ref_key:"navigatorImageElement",ref:o,src:t(r)(t(d).filename),alt:t(d).title,class:"w-full h-full object-contain cursor-pointer",onClick:z,draggable:"false"},null,8,ds)):W("",!0),k.value?(c(),u("div",{key:1,class:"absolute border-2 border-red-500 bg-red-500 bg-opacity-20 pointer-events-none",style:te({left:k.value.left+"px",top:k.value.top+"px",width:k.value.width+"px",height:k.value.height+"px"})},null,4)):W("",!0)],512),e("div",vs,[e("span",null,w(Math.round(t(g)*100))+"%",1),e("button",{onClick:m[0]||(m[0]=(...E)=>t(I)&&t(I)(...E)),class:"px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded text-white transition-colors",title:"重置"},m[2]||(m[2]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))])],34)],36)),[[vt,t($)&&t(d)]])}}),ms={class:"relative"},hs={class:"relative"},ps=["onClick","title"],fs=["src","alt"],ys={key:0,class:"absolute inset-0 rounded-full bg-gradient-to-r from-blue-500/20 to-purple-600/20 animate-pulse"},bs={class:"text-white text-xs font-medium"},xs=ne({__name:"RadialNavigation",setup(b){const v=ye(),{getImagePath:r}=ve(),{viewerImages:$,currentImageIndex:h,previousImageIndex:S,isTransitioning:M,posMap:d,animating:g,showInfoPanel:P,infoPanelWidth:N}=re(v),{selectRadialImage:f,handleCenterButtonClick:n,updatePosMap:l}=v;return ce(h,I=>{g.value||l(I)}),ce($,()=>l(h.value)),Ce(()=>{l(h.value)}),(I,s)=>t($).length>1?(c(),u("div",{key:0,class:"absolute bottom-8 transform -translate-x-1/2",style:te({left:t(P)?`calc(50% - ${t(N)/2}px)`:"50%"})},[e("div",ms,[e("div",hs,[(c(!0),u(pe,null,fe(t($),(o,k)=>{var z,Y;return c(),u("button",{key:o.id,onClick:D=>t(f)(k),style:te({position:"absolute",left:"50%",top:"50%",width:"48px",height:"48px",transform:`translate(-50%, -50%) translate(${((z=t(d)[k])==null?void 0:z.x)||0}px, ${((Y=t(d)[k])==null?void 0:Y.y)||0}px)`,opacity:k===t(h)?1:t(M)&&k===t(S)?0:.6,zIndex:k===t(h)?30:20,transition:"opacity 0.4s ease-out, transform 0.4s ease-out"}),class:Q(["rounded-full border-2 overflow-hidden bg-gray-800 bg-opacity-80 hover:scale-110 transition-all duration-300",k===t(h)?"border-white shadow-2xl shadow-blue-500/60 radial-nav-active":"border-gray-600 hover:border-white"]),title:`${o.title} (${k+1}/${t($).length})`},[e("img",{src:t(r)(o.filename),alt:o.title,class:"w-full h-full object-cover"},null,8,fs),k===t(h)?(c(),u("div",ys)):W("",!0)],14,ps)}),128))]),e("button",{onClick:s[0]||(s[0]=(...o)=>t(n)&&t(n)(...o)),class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-black bg-opacity-70 backdrop-blur-sm rounded-full border-2 border-white border-opacity-30 hover:border-opacity-60 transition-colors duration-200 flex items-center justify-center z-40"},[e("div",bs,w(t(h)+1)+"/"+w(t($).length),1)]),s[1]||(s[1]=e("div",{class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 opacity-10 scale-150 animate-pulse pointer-events-none w-20 h-20"},null,-1))])],4)):W("",!0)}}),ws=De(xs,[["__scopeId","data-v-1d363c75"]]),ks={key:0,class:"fixed inset-0 z-[9999] bg-black bg-opacity-90 backdrop-blur-sm"},_s={class:"relative w-full h-full flex"},$s={class:"flex items-center space-x-4 bg-black bg-opacity-50 backdrop-blur-sm rounded-lg px-4 py-2"},Is={class:"text-white"},Ms={class:"font-medium"},Cs={class:"text-sm text-gray-300"},Ss={class:"flex items-center space-x-2 bg-black bg-opacity-50 backdrop-blur-sm rounded-lg px-2 py-2"},Ts=["disabled"],Es={class:"text-white text-sm min-w-[60px] text-center"},Ls=["disabled"],Ds=["title"],Ps={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ns={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ws=["src","alt"],js={key:1,class:"absolute inset-0 flex items-center justify-center"},zs=ne({__name:"ImageViewer",setup(b){const v=ye(),{getImagePath:r}=ve(),{isOpen:$,viewerImages:h,currentImageIndex:S,viewerScale:M,viewerTranslateX:d,viewerTranslateY:g,isDragging:P,fitToScreen:N,dragSensitivity:f,showInfoPanel:n,infoPanelWidth:l,currentViewerImage:I,canZoomIn:s,canZoomOut:o,hasPrevious:k,hasNext:z,imageStyle:Y}=re(v),{closeImageViewer:D,goToPreviousImage:m,goToNextImage:E,resetTransform:C,toggleFitToScreen:B,zoomIn:F,zoomOut:O,toggleInfoPanel:U,initNavigatorPosition:Z}=v,J=L(),j=p=>{$.value&&(p.deltaY<0?F():O())},x=p=>{if(M.value<=1)return;p.preventDefault(),p.stopPropagation(),P.value=!0;const a=p.clientX-d.value/f.value,T=p.clientY-g.value/f.value;let i=null;const X=H=>{P.value&&(H.preventDefault(),H.stopPropagation(),i&&cancelAnimationFrame(i),i=requestAnimationFrame(()=>{d.value=(H.clientX-a)*f.value,g.value=(H.clientY-T)*f.value}))},A=H=>{H.preventDefault(),H.stopPropagation(),P.value=!1,i&&(cancelAnimationFrame(i),i=null),document.removeEventListener("mousemove",X,{capture:!0}),document.removeEventListener("mouseup",A,{capture:!0})};document.addEventListener("mousemove",X,{capture:!0,passive:!1}),document.addEventListener("mouseup",A,{capture:!0,passive:!1})},le=p=>{if(M.value<=1||p.touches.length!==1)return;p.preventDefault(),p.stopPropagation(),P.value=!0;const a=p.touches[0],T=a.clientX-d.value/f.value,i=a.clientY-g.value/f.value;let X=null;const A=R=>{if(!P.value||R.touches.length!==1)return;R.preventDefault(),R.stopPropagation();const oe=R.touches[0];X&&cancelAnimationFrame(X),X=requestAnimationFrame(()=>{d.value=(oe.clientX-T)*f.value,g.value=(oe.clientY-i)*f.value})},H=R=>{R.preventDefault(),R.stopPropagation(),P.value=!1,X&&(cancelAnimationFrame(X),X=null),document.removeEventListener("touchmove",A,{capture:!0}),document.removeEventListener("touchend",H,{capture:!0})};document.addEventListener("touchmove",A,{capture:!0,passive:!1}),document.addEventListener("touchend",H,{capture:!0,passive:!1})},y=p=>{if($.value){switch(p.key){case"Escape":D();break;case"ArrowLeft":m();break;case"ArrowRight":E();break;case"+":case"=":F();break;case"-":case"_":O();break;case"0":C();break;case"1":B();break;case"i":case"I":U();break}if(p.ctrlKey)switch(p.key){case"+":case"=":p.preventDefault(),F();break;case"-":case"_":p.preventDefault(),O();break}}};return Ce(()=>{Z(),document.addEventListener("keydown",y)}),Ye(()=>{document.removeEventListener("keydown",y),document.body.style.overflow=""}),(p,a)=>{var T;return t($)?(c(),u("div",ks,[e("div",{onClick:a[0]||(a[0]=(...i)=>t(D)&&t(D)(...i)),class:"absolute inset-0"}),e("div",_s,[e("div",{class:"image-viewer-area flex-1 flex items-center justify-center p-4 transition-all duration-300",style:te({marginRight:t(n)?t(l)+"px":"0px"}),onWheel:he(j,["prevent"])},[e("div",{class:"absolute top-4 left-4 z-10 flex items-center justify-between",style:te({right:t(n)?t(l)+16+"px":"16px"})},[e("div",$s,[e("div",Is,[e("h3",Ms,w(((T=t(I))==null?void 0:T.title)||"未命名"),1),e("p",Cs,w(t(S)+1)+" / "+w(t(h).length),1)])]),e("div",Ss,[e("button",{onClick:a[1]||(a[1]=(...i)=>t(O)&&t(O)(...i)),disabled:!t(o),class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"縮小 (Ctrl + -)"},a[12]||(a[12]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"})],-1)]),8,Ts),e("span",Es,w(Math.round(t(M)*100))+"%",1),e("button",{onClick:a[2]||(a[2]=(...i)=>t(F)&&t(F)(...i)),disabled:!t(s),class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"放大 (Ctrl + +)"},a[13]||(a[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})],-1)]),8,Ls),e("button",{onClick:a[3]||(a[3]=(...i)=>t(B)&&t(B)(...i)),class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:t(N)?"顯示原始大小":"適應螢幕"},[t(N)?(c(),u("svg",Ps,a[14]||(a[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"},null,-1)]))):(c(),u("svg",Ns,a[15]||(a[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"},null,-1)])))],8,Ds),e("button",{onClick:a[4]||(a[4]=(...i)=>t(C)&&t(C)(...i)),class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:"重置縮放 (0)"},a[16]||(a[16]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])),e("button",{onClick:a[5]||(a[5]=(...i)=>t(U)&&t(U)(...i)),class:Q(["p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",{"bg-white bg-opacity-20":t(n)}]),title:"圖片資訊 (I)"},a[17]||(a[17]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),2),e("button",{onClick:a[6]||(a[6]=(...i)=>t(D)&&t(D)(...i)),class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:"關閉 (Esc)"},a[18]||(a[18]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])],4),e("div",{class:"relative w-full h-full flex items-center justify-center overflow-hidden",onClick:a[9]||(a[9]=he(()=>{},["stop"]))},[t(I)?(c(),u("img",{key:0,ref_key:"imageElement",ref:J,src:t(r)(t(I).filename),alt:t(I).title,class:Q(["select-none user-select-none",t(P)?"cursor-grabbing":t(M)>1?"cursor-grab":"cursor-default",t(P)?"":"transition-transform duration-200 ease-out"]),style:te(t(Y)),draggable:"false",onClick:a[7]||(a[7]=he(()=>{},["stop"])),onMousedown:x,onTouchstart:le,onContextmenu:a[8]||(a[8]=he(()=>{},["prevent"]))},null,46,Ws)):W("",!0),t(I)?W("",!0):(c(),u("div",js,a[19]||(a[19]=[e("div",{class:"text-white text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e("p",null,"載入中...")],-1)])))]),t(h).length>1&&t(k)?(c(),u("button",{key:0,onClick:a[10]||(a[10]=(...i)=>t(m)&&t(m)(...i)),class:"absolute left-4 top-1/2 transform -translate-y-1/2 p-3 bg-black bg-opacity-50 backdrop-blur-sm text-white rounded-full hover:bg-opacity-70 transition-colors",title:"上一張 (←)"},a[20]||(a[20]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):W("",!0),t(h).length>1&&t(z)?(c(),u("button",{key:1,onClick:a[11]||(a[11]=(...i)=>t(E)&&t(E)(...i)),class:"absolute top-1/2 transform -translate-y-1/2 p-3 bg-black bg-opacity-50 backdrop-blur-sm text-white rounded-full hover:bg-opacity-70 transition-colors",style:te({right:t(n)?t(l)+16+"px":"16px"}),title:"下一張 (→)"},a[21]||(a[21]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),4)):W("",!0),ie(ws),ie(gs)],36)]),ie(us)])):W("",!0)}}}),Xs=De(zs,[["__scopeId","data-v-f69f4828"]]),Vs={class:"min-h-screen bg-stone-50/30"},Ys={class:"container mx-auto px-6 py-20"},Bs={class:"max-w-4xl mx-auto"},As={class:"mb-8"},Hs={class:"mb-16"},Rs={class:"container mx-auto px-6 relative"},Fs={key:0,class:"text-center py-20"},Os={key:1,class:"space-y-24 max-w-6xl mx-auto"},Gs={class:"mb-8 border border-stone-200/60 rounded-xl hover:border-stone-300/80 transition-all duration-500"},Ks={class:"p-8 border-b border-stone-200/40"},qs={class:"flex items-center justify-between"},Us={class:"text-2xl font-extralight text-stone-800 tracking-wider leading-relaxed"},Qs=["onClick"],Zs={class:"text-sm text-stone-500 mt-4 font-light tracking-wide"},Js={class:"p-6"},ea={class:"grid grid-cols-3 gap-3"},ta=["onClick"],oa=["src","alt"],sa={key:0,class:"text-center mt-6"},aa={class:"text-xs text-stone-400 font-light tracking-wide"},na={key:0,class:"space-y-12 ml-6 border-l border-stone-200/40 pl-8 pb-8 relative"},ra={key:0,class:"absolute top-full left-0 right-0 z-0 flex justify-between px-10",style:{height:"3rem"}},la=ne({__name:"gallery",setup(b){const v=xe(),{mixedPhotoItems:r,expandedGroups:$,isLoading:h,digitalError:S,photographyError:M}=re(v),{loadAllWorks:d,toggleGroupExpansion:g}=v,P=ye(),N=Ve(),{getImagePath:f}=ve(),n=I=>$.value[I]||!1,l=(I,s)=>{P.openImageViewer(I,s)};return ce([S,M],([I,s])=>{I&&N.error("載入數位作品失敗","請檢查網路連線或稍後再試"),s&&N.error("載入攝影作品失敗","請檢查網路連線或稍後再試")}),Ce(async()=>{try{if(await N.promise(d(),{loading:"載入作品中...",success:"作品載入完成！",error:"載入作品失敗"}),r.value.length>0){const I=r.value[0];I.eventName?g(I.eventName):g("no-event")}}catch(I){console.error("Failed to load works:",I)}}),bt({title:"Works - 作品集",meta:[{name:"description",content:"數位藝術與攝影作品集"}]}),(I,s)=>(c(),u("div",Vs,[e("div",Ys,[e("div",Bs,[s[0]||(s[0]=e("h1",{class:"text-5xl font-extralight text-stone-800 mb-6 tracking-wider leading-tight"},"Works",-1)),s[1]||(s[1]=e("p",{class:"text-stone-600 font-light mb-12 text-lg leading-relaxed tracking-wide"},"作品集 - Digital Art & Photography",-1)),e("div",As,[ie(St)]),e("div",Hs,[ie(Dt)])])]),e("div",Rs,[s[5]||(s[5]=e("div",{class:"absolute left-12 top-0 bottom-0 w-px bg-stone-200/60 hidden md:block"},null,-1)),t(h)?(c(),u("div",Fs,s[2]||(s[2]=[e("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-b border-stone-300"},null,-1),e("p",{class:"mt-6 text-stone-500 font-light tracking-wide"},"載入中...",-1)]))):(c(),u("div",Os,[(c(!0),u(pe,null,fe(t(r),(o,k)=>(c(),gt(Bt,{key:o.key,index:k,"time-label":o.timeRange||"","event-info":o.eventInfo,"event-key":o.eventName||"no-event","show-event-control":!!o.eventName,"show-event-info":!!o.eventName},{default:mt(()=>{var z,Y,D;return[e("div",Gs,[e("div",Ks,[e("div",qs,[e("h3",Us,w(o.eventName||"其他作品"),1),e("button",{onClick:m=>t(g)(o.eventName||"no-event"),class:"flex items-center gap-3 px-4 py-2 text-sm text-stone-500 hover:text-stone-700 border border-stone-200/60 rounded-lg transition-all duration-300 hover:bg-stone-50/50 font-light tracking-wide"},[e("span",null,w(n(o.eventName||"no-event")?"收起":"展開"),1),(c(),u("svg",{class:Q(["w-4 h-4 transform transition-transform duration-300 opacity-70",n(o.eventName||"no-event")?"rotate-180":""]),fill:"currentColor",viewBox:"0 0 20 20"},s[3]||(s[3]=[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))],8,Qs)]),e("p",Zs,w(((z=o.images)==null?void 0:z.length)||0)+" 張作品",1)]),e("div",Js,[e("div",ea,[(c(!0),u(pe,null,fe((o.images||[]).slice(0,3),(m,E)=>(c(),u("div",{key:m.filename,onClick:C=>l(m,o.images||[]),class:"aspect-square rounded-lg overflow-hidden border border-stone-200/50 cursor-pointer group hover:border-stone-300/70 transition-all duration-300"},[e("img",{src:t(f)(m.filename),alt:m.title,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 ease-out"},null,8,oa)],8,ta))),128))]),(((Y=o.images)==null?void 0:Y.length)||0)>3?(c(),u("div",sa,[e("span",aa,"還有 "+w((((D=o.images)==null?void 0:D.length)||0)-3)+" 張作品",1)])):W("",!0)]),n(o.eventName||"no-event")?(c(),u("div",na,[(c(!0),u(pe,null,fe(o.images||[],(m,E)=>{var C;return c(),u("div",{key:m.filename,class:"relative"},[E<(((C=o.images)==null?void 0:C.length)||0)-1?(c(),u("div",ra,s[4]||(s[4]=[e("div",{class:"w-px h-full bg-stone-200/50"},null,-1),e("div",{class:"w-px h-full bg-stone-200/50"},null,-1)]))):W("",!0),ie(po,{image:m,onOpenViewer:B=>l(B,o.images||[])},null,8,["image","onOpenViewer"])])}),128))])):W("",!0)])]}),_:2},1032,["index","time-label","event-info","event-key","show-event-control","show-event-info"]))),128))]))]),s[6]||(s[6]=e("div",{class:"container mx-auto px-6 py-24 text-center"},[e("div",{class:"text-3xl font-extralight text-stone-300 italic tracking-wider"},"friday vibes"),e("div",{class:"text-sm text-stone-400 mt-4 font-light tracking-wide"},"thank god it's friday!")],-1)),ie(Xs)]))}}),ma=De(la,[["__scopeId","data-v-6c55458e"]]);export{ma as default};
